(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{326:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"概览"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概览","aria-hidden":"true"}},[s._v("#")]),s._v(" 概览")]),s._v(" "),t("h2",{attrs:{id:"生命周期"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生命周期","aria-hidden":"true"}},[s._v("#")]),s._v(" 生命周期")]),s._v(" "),t("ul",[t("li",[s._v("OPTIONAL Install "),t("code",[s._v("apt addons")])]),s._v(" "),t("li",[s._v("OPTIONAL Install "),t("code",[s._v("cache components")])]),s._v(" "),t("li",[t("code",[s._v("before_install")])]),s._v(" "),t("li",[t("code",[s._v("install")])]),s._v(" "),t("li",[t("code",[s._v("before_script")])]),s._v(" "),t("li",[t("code",[s._v("script")])]),s._v(" "),t("li",[s._v("OPTIONAL "),t("code",[s._v("before_cache")]),s._v(" (for cleaning up cache)")]),s._v(" "),t("li",[t("code",[s._v("after_success")]),s._v(" or "),t("code",[s._v("after_failure")])]),s._v(" "),t("li",[s._v("OPTIONAL "),t("code",[s._v("before_deploy")])]),s._v(" "),t("li",[s._v("OPTIONAL "),t("code",[s._v("deploy")])]),s._v(" "),t("li",[s._v("OPTIONAL "),t("code",[s._v("after_deploy")])]),s._v(" "),t("li",[t("code",[s._v("after_script")])])]),s._v(" "),t("h2",{attrs:{id:"常用配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 常用配置")]),s._v(" "),t("h3",{attrs:{id:"添加授信主机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加授信主机","aria-hidden":"true"}},[s._v("#")]),s._v(" 添加授信主机")]),s._v(" "),t("p",[s._v("部署项目到自己服务器的时候需要添加")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{attrs:{class:"token key atrule"}},[s._v("addons")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("ssh_known_hosts")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 106.12.140.131\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"部署到-gh-pages"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#部署到-gh-pages","aria-hidden":"true"}},[s._v("#")]),s._v(" 部署到 gh-pages")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{attrs:{class:"token key atrule"}},[s._v("deploy")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("provider")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pages\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("skip-cleanup")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("github-token")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v('"$GITHUB_TOKEN"')]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("keep-history")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("local_dir")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docs/.vuepress/dist\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{attrs:{class:"token key atrule"}},[s._v("branch")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"缓存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缓存","aria-hidden":"true"}},[s._v("#")]),s._v(" 缓存")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{attrs:{class:"token key atrule"}},[s._v("cache")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("directories")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node_modules\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#模板","aria-hidden":"true"}},[s._v("#")]),s._v(" 模板")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{attrs:{class:"token key atrule"}},[s._v("language")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node_js\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("node_js")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("8")]),s._v("\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("cache")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("directories")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node_modules\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("sudo")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" required\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" docker\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("branches")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("only")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" master\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("addons")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("ssh_known_hosts")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 106.12.140.131\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("before_install")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" openssl aes"),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("256"),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cbc "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("K $encrypted_2a01126f8b17_key "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("iv $encrypted_2a01126f8b17_iv\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("in id_rsa.enc "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("out ~/.ssh/id_rsa "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" chmod 600 ~/.ssh/id_rsa\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" echo "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v('e "Host $HOST\\n\\tStrictHostKeyChecking no\\n" '),t("span",{attrs:{class:"token punctuation"}},[s._v(">")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" ~/.ssh/config\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("install")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" yarn install\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("before_script")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("script")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" yarn run docs"),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("build\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("before_cache")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("after_success")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" scp "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("o stricthostkeychecking=no "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v('r docs/.vuepress/dist root@"$HOST"'),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/root\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("after_failure")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("before_deploy")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("deploy")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("provider")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pages\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("skip-cleanup")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("github-token")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v('"$GITHUB_TOKEN"')]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("keep-history")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("local_dir")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docs/.vuepress/dist\n  "),t("span",{attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{attrs:{class:"token key atrule"}},[s._v("branch")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("after_deploy")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" yarn run notification\n  "),t("span",{attrs:{class:"token comment"}},[s._v("# 执行服务器上的命令")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v(' ssh root@"$HOST" '),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("o StrictHostKeyChecking=no 'docker pull jolylai/notebook && docker run "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p 80"),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v("80'\n"),t("span",{attrs:{class:"token key atrule"}},[s._v("after_script")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("-")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br")])])])}],!1,null,null,null);a.default=e.exports}}]);